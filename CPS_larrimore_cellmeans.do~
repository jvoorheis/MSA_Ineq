*Imposing Larrimore (2008) extended topcodes for 1976-1995 data
*Note: from 1976 - 1987,  personal income is incwage + incbus + incfarm + incss + incssi + incasist + incint + incdrt + incretir + incother
*Wages (1976-1987)
gen incwage_cellmean = incwage if year<1988
replace incwage_cellmean = 65013 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1976 & incwage~=.
replace incwage_cellmean = 60612 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1976 & incwage~=.
replace incwage_cellmean = 60612 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1976 & incwage~=.
replace incwage_cellmean = 68598 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1976 & incwage~=.
replace incwage_cellmean = 64197 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1977 & incwage~=.
replace incwage_cellmean = 62351 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1977 & incwage~=.
replace incwage_cellmean = 63207 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1977 & incwage~=.
replace incwage_cellmean = 70337 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1977 & incwage~=.
replace incwage_cellmean = 62351 if incwage>=50000 & female==0 & fulltime==0 & black==1 & year==1977 & incwage~=.
replace incwage_cellmean = 65436 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1978 & incwage~=.
replace incwage_cellmean = 70047 if incwage>=50000 & female==0 & fulltime==1 & black==1 & year==1978 & incwage~=.
replace incwage_cellmean = 70047 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1978 & incwage~=.
replace incwage_cellmean = 59625 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1978 & incwage~=.
replace incwage_cellmean = 70047 if incwage>=50000 & female==1 & fulltime==1 & black==1 & year==1978 & incwage~=.
replace incwage_cellmean = 67600 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1978 & incwage~=.
replace incwage_cellmean = 70047 if incwage>=50000 & female==0 & fulltime==0 & latino==1 & year==1978 & incwage~=.
replace incwage_cellmean = 70047 if incwage>=50000 & female==1 & fulltime==0 & white==1 & year==1978 & incwage~=.
replace incwage_cellmean = 66128 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1979 & incwage~=.
replace incwage_cellmean = 64292 if incwage>=50000 & female==0 & fulltime==1 & black==1 & year==1979 & incwage~=.
replace incwage_cellmean = 73370 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1979 & incwage~=.
replace incwage_cellmean = 63549 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1979 & incwage~=.
replace incwage_cellmean = 64292 if incwage>=50000 & female==1 & fulltime==1 & black==1 & year==1979 & incwage~=.
replace incwage_cellmean = 72495 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1979 & incwage~=.
replace incwage_cellmean = 64292 if incwage>=50000 & female==0 & fulltime==0 & latino==1 & year==1979 & incwage~=.
replace incwage_cellmean = 65016 if incwage>=50000 & female==1 & fulltime==0 & white==1 & year==1979 & incwage~=.
replace incwage_cellmean = 67737 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1980 & incwage~=.
replace incwage_cellmean = 63925 if incwage>=50000 & female==0 & fulltime==1 & black==1 & year==1980 & incwage~=.
replace incwage_cellmean = 64371 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1980 & incwage~=.
replace incwage_cellmean = 62874 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1980 & incwage~=.
replace incwage_cellmean = 72125 if incwage>=50000 & female==1 & fulltime==1 & black==1 & year==1980 & incwage~=.
replace incwage_cellmean = 72125 if incwage>=50000 & female==1 & fulltime==1 & latino==1 & year==1980 & incwage~=.
replace incwage_cellmean = 68818 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1980 & incwage~=.
replace incwage_cellmean = 70963 if incwage>=50000 & female==0 & fulltime==0 & latino==1 & year==1980 & incwage~=.
replace incwage_cellmean = 72125 if incwage>=50000 & female==1 & fulltime==0 & white==1 & year==1980 & incwage~=.
replace incwage_cellmean = 66210 if incwage>=50000 & female==0 & fulltime==1 & white==1 & year==1981 & incwage~=.
replace incwage_cellmean = 58990 if incwage>=50000 & female==0 & fulltime==1 & black==1 & year==1981 & incwage~=.
replace incwage_cellmean = 68661 if incwage>=50000 & female==0 & fulltime==1 & latino==1 & year==1981 & incwage~=.
replace incwage_cellmean = 60852 if incwage>=50000 & female==1 & fulltime==1 & white==1 & year==1981 & incwage~=.
replace incwage_cellmean = 55631 if incwage>=50000 & female==1 & fulltime==1 & black==1 & year==1981 & incwage~=.
replace incwage_cellmean = 55631 if incwage>=50000 & female==1 & fulltime==1 & latino==1 & year==1981 & incwage~=.
replace incwage_cellmean = 70415 if incwage>=50000 & female==0 & fulltime==0 & white==1 & year==1981 & incwage~=.
replace incwage_cellmean = 65397 if incwage>=50000 & female==0 & fulltime==0 & black==1 & year==1981 & incwage~=.
replace incwage_cellmean = 55631 if incwage>=50000 & female==0 & fulltime==0 & latino==1 & year==1981 & incwage~=.
replace incwage_cellmean = 85119 if incwage>=50000 & female==1 & fulltime==0 & white==1 & year==1981 & incwage~=.
replace incwage_cellmean = 55631 if incwage>=50000 & female==1 & fulltime==0 & latino==1 & year==1981 & incwage~=.
replace incwage_cellmean = 91610 if incwage>=75000 & female==0 & fulltime==1 & white==1 & year==1982 & incwage~=.
replace incwage_cellmean = 90491 if incwage>=75000 & female==0 & fulltime==1 & latino==1 & year==1982 & incwage~=.
replace incwage_cellmean = 83489 if incwage>=75000 & female==1 & fulltime==1 & white==1 & year==1982 & incwage~=.
replace incwage_cellmean = 94607 if incwage>=75000 & female==0 & fulltime==0 & white==1 & year==1982 & incwage~=.
replace incwage_cellmean = 90491 if incwage>=75000 & female==0 & fulltime==0 & black==1 & year==1982 & incwage~=.
replace incwage_cellmean = 89485 if incwage>=75000 & female==0 & fulltime==1 & white==1 & year==1983 & incwage~=.
replace incwage_cellmean = 87647 if incwage>=75000 & female==0 & fulltime==1 & black==1 & year==1983 & incwage~=.
replace incwage_cellmean = 96915 if incwage>=75000 & female==0 & fulltime==1 & latino==1 & year==1983 & incwage~=.
replace incwage_cellmean = 92340 if incwage>=75000 & female==1 & fulltime==1 & white==1 & year==1983 & incwage~=.
replace incwage_cellmean = 87647 if incwage>=75000 & female==1 & fulltime==1 & black==1 & year==1983 & incwage~=.
replace incwage_cellmean = 88228 if incwage>=75000 & female==0 & fulltime==0 & white==1 & year==1983 & incwage~=.
replace incwage_cellmean = 87647 if incwage>=75000 & female==0 & fulltime==0 & latino==1 & year==1983 & incwage~=.
replace incwage_cellmean = 87647 if incwage>=75000 & female==1 & fulltime==0 & white==1 & year==1983 & incwage~=.
replace incwage_cellmean = 90220 if incwage>=75000 & female==0 & fulltime==1 & white==1 & year==1984 & incwage~=.
replace incwage_cellmean = 92530 if incwage>=75000 & female==0 & fulltime==1 & latino==1 & year==1984 & incwage~=.
replace incwage_cellmean = 88528 if incwage>=75000 & female==1 & fulltime==1 & white==1 & year==1984 & incwage~=.
replace incwage_cellmean = 95586 if incwage>=75000 & female==0 & fulltime==0 & white==1 & year==1984 & incwage~=.
replace incwage_cellmean = 92530 if incwage>=75000 & female==1 & fulltime==0 & white==1 & year==1984 & incwage~=.
replace incwage_cellmean = 92350 if incwage>=75000 & female==1 & fulltime==0 & latino==1 & year==1984 & incwage~=.
*1985 internal censoring is identical to topcode, so no cellmean imputation is possible
replace incwage_cellmean = 136613 if incwage>=99999 & female==0 & fulltime==1 & white==1 & year==1986 & incwage~=.
replace incwage_cellmean = 170804 if incwage>=99999 & female==0 & fulltime==1 & black==1 & year==1986 & incwage~=.
replace incwage_cellmean = 124324 if incwage>=99999 & female==0 & fulltime==1 & latino==1 & year==1986 & incwage~=.
replace incwage_cellmean = 133348 if incwage>=99999 & female==1 & fulltime==1 & white==1 & year==1986 & incwage~=.
replace incwage_cellmean = 137028 if incwage>=99999 & female==0 & fulltime==0 & white==1 & year==1986 & incwage~=.
replace incwage_cellmean = 170804 if incwage>=99999 & female==1 & fulltime==0 & white==1 & year==1986 & incwage~=.
replace incwage_cellmean = 140359 if incwage>=99999 & female==0 & fulltime==1 & white==1 & year==1987 & incwage~=.
replace incwage_cellmean = 119934 if incwage>=99999 & female==0 & fulltime==1 & black==1 & year==1987 & incwage~=.
replace incwage_cellmean = 150042 if incwage>=99999 & female==0 & fulltime==1 & latino==1 & year==1987 & incwage~=.
replace incwage_cellmean = 125434 if incwage>=99999 & female==1 & fulltime==1 & white==1 & year==1987 & incwage~=.
replace incwage_cellmean = 169047 if incwage>=99999 & female==1 & fulltime==1 & black==1 & year==1987 & incwage~=.
replace incwage_cellmean = 137893 if incwage>=99999 & female==0 & fulltime==0 & white==1 & year==1987 & incwage~=.
replace incwage_cellmean = 150042 if incwage>=99999 & female==0 & fulltime==0 & black==1 & year==1987 & incwage~=.
replace incwage_cellmean = 150042 if incwage>=99999 & female==1 & fulltime==0 & white==1 & year==1987 & incwage~=.

*Self Employment Income, 1976-1987 (incbus)
gen incbus_cellmean = incbus if year<1988
replace incbus_cellmean = 69286 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1976 & incbus~=.
replace incbus_cellmean = 62217 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1976 & incbus~=.
replace incbus_cellmean = 62217 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1976 & incbus~=.
replace incbus_cellmean = 62217 if incbus>=50000 & female==0 & fulltime==0 & latino==1 & year==1976 & incbus~=.
replace incbus_cellmean = 65763 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1977 & incbus~=.
replace incbus_cellmean = 79290 if incbus>=50000 & female==0 & fulltime==1 & black==1 & year==1977 & incbus~=.
replace incbus_cellmean = 79290 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1977 & incbus~=.
replace incbus_cellmean = 79290 if incbus>=50000 & female==1 & fulltime==1 & white==1 & year==1977 & incbus~=.
replace incbus_cellmean = 68452 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1977& incbus~=.
replace incbus_cellmean = 67885 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1978& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1978& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==1 & fulltime==1 & white==1 & year==1978& incbus~=.
replace incbus_cellmean = 62707 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1978& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==0 & fulltime==0 & black==1 & year==1978& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==1 & fulltime==0 & white==1 & year==1978& incbus~=.
replace incbus_cellmean = 68168 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1979& incbus~=.
replace incbus_cellmean = 56976 if incbus>=50000 & female==0 & fulltime==1 & black==1 & year==1979& incbus~=.
replace incbus_cellmean = 56976 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1979& incbus~=.
replace incbus_cellmean = 53503 if incbus>=50000 & female==1 & fulltime==1 & white==1 & year==1979& incbus~=.
replace incbus_cellmean = 71237 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1979& incbus~=.
replace incbus_cellmean = 56976 if incbus>=50000 & female==1 & fulltime==0 & white==1 & year==1979& incbus~=.
replace incbus_cellmean = 69954 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1980& incbus~=.
replace incbus_cellmean = 72753 if incbus>=50000 & female==0 & fulltime==1 & black==1 & year==1980& incbus~=.
replace incbus_cellmean = 55589 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1980& incbus~=.
replace incbus_cellmean = 72753 if incbus>=50000 & female==1 & fulltime==1 & white==1 & year==1980& incbus~=.
replace incbus_cellmean = 70074 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1980& incbus~=.
replace incbus_cellmean = 72753 if incbus>=50000 & female==0 & fulltime==0 & latino==1 & year==1980& incbus~=.
replace incbus_cellmean = 72753 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1980& incbus~=.
replace incbus_cellmean = 71645 if incbus>=50000 & female==0 & fulltime==1 & white==1 & year==1981& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==0 & fulltime==1 & black==1 & year==1981& incbus~=.
replace incbus_cellmean = 73083 if incbus>=50000 & female==0 & fulltime==1 & latino==1 & year==1981& incbus~=.
replace incbus_cellmean = 81331 if incbus>=50000 & female==1 & fulltime==1 & white==1 & year==1981& incbus~=.
replace incbus_cellmean = 63109 if incbus>=50000 & female==0 & fulltime==0 & white==1 & year==1981& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==0 & fulltime==0 & latino==1 & year==1981& incbus~=.
replace incbus_cellmean = 56602 if incbus>=50000 & female==1 & fulltime==0 & white==1 & year==1981& incbus~=.
replace incbus_cellmean = 89700 if incbus>=75000 & female==0 & fulltime==1 & white==1 & year==1982& incbus~=.
replace incbus_cellmean = 95061 if incbus>=75000 & female==0 & fulltime==1 & latino==1 & year==1982& incbus~=.
replace incbus_cellmean = 95061 if incbus>=75000 & female==1 & fulltime==1 & white==1 & year==1982& incbus~=.
replace incbus_cellmean = 92898 if incbus>=75000 & female==0 & fulltime==0 & white==1 & year==1982& incbus~=.
replace incbus_cellmean = 95061 if incbus>=75000 & female==0 & fulltime==0 & latino==1 & year==1982& incbus~=.
replace incbus_cellmean = 95061 if incbus>=75000 & female==1 & fulltime==0 & white==1 & year==1982& incbus~=.
replace incbus_cellmean = 88987 if incbus>=75000 & female==0 & fulltime==1 & white==1 & year==1983& incbus~=.
replace incbus_cellmean = 90965 if incbus>=75000 & female==0 & fulltime==1 & black==1 & year==1983& incbus~=.
replace incbus_cellmean = 90965 if incbus>=75000 & female==0 & fulltime==1 & latino==1 & year==1983& incbus~=.
replace incbus_cellmean = 90608 if incbus>=75000 & female==1 & fulltime==1 & white==1 & year==1983& incbus~=.
replace incbus_cellmean = 90964 if incbus>=75000 & female==1 & fulltime==1 & latino==1 & year==1983& incbus~=.
replace incbus_cellmean = 87585 if incbus>=75000 & female==0 & fulltime==0 & white==1 & year==1983& incbus~=.
replace incbus_cellmean = 92506 if incbus>=75000 & female==0 & fulltime==1 & white==1 & year==1984& incbus~=.
replace incbus_cellmean = 86400 if incbus>=75000 & female==0 & fulltime==1 & black==1 & year==1984& incbus~=.
replace incbus_cellmean = 86400 if incbus>=75000 & female==0 & fulltime==1 & latino==1 & year==1984& incbus~=.
replace incbus_cellmean = 89529 if incbus>=75000 & female==1 & fulltime==1 & white==1 & year==1984& incbus~=.
replace incbus_cellmean = 89588 if incbus>=75000 & female==0 & fulltime==0 & white==1 & year==1984& incbus~=.
replace incbus_cellmean = 86400 if incbus>=75000 & female==1 & fulltime==0 & white==1 & year==1984& incbus~=.
replace incbus_cellmean = 136144 if incbus>=99999 & female==0 & fulltime==1 & white==1 & year==1986& incbus~=.
replace incbus_cellmean = 108836 if incbus>=99999 & female==0 & fulltime==1 & black==1 & year==1986& incbus~=.
replace incbus_cellmean = 108836 if incbus>=99999 & female==1 & fulltime==1 & white==1 & year==1986& incbus~=.
replace incbus_cellmean = 108836 if incbus>=99999 & female==1 & fulltime==1 & latino==1 & year==1986& incbus~=.
replace incbus_cellmean = 106879 if incbus>=99999 & female==0 & fulltime==0 & white==1 & year==1986& incbus~=.
replace incbus_cellmean = 108836 if incbus>=99999 & female==1 & fulltime==0 & white==1 & year==1986& incbus~=.
replace incbus_cellmean = 108836 if incbus>=99999 & female==1 & fulltime==0 & latino==1 & year==1986& incbus~=.
replace incbus_cellmean = 130751 if incbus>=99999 & female==0 & fulltime==1 & white==1 & year==1987& incbus~=.
replace incbus_cellmean = 170968 if incbus>=99999 & female==0 & fulltime==1 & latino==1 & year==1987& incbus~=.
replace incbus_cellmean = 144319 if incbus>=99999 & female==0 & fulltime==0 & white==1 & year==1987& incbus~=.
replace incbus_cellmean = 170968 if incbus>=99999 & female==0 & fulltime==0 & latino==1 & year==1987& incbus~=.
replace incbus_cellmean = 170968 if incbus>=99999 & female==1 & fulltime==0 & white==1 & year==1987& incbus~=.

*Farm income (incfarm) 1976-1987
gen incfarm_cellmean = incfarm if year<1988
replace incfarm_cellmean = 67970 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1976 & incfarm~=.
replace incfarm_cellmean = 67970 if incfarm>=50000 & female==1 & fulltime==0 & white==1 & year==1976 & incfarm~=.
replace incfarm_cellmean = 61813 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1977 & incfarm~=.
replace incfarm_cellmean = 61813 if incfarm>=50000 & female==0 & fulltime==1 & black==1 & year==1977 & incfarm~=.
replace incfarm_cellmean = 61813 if incfarm>=50000 & female==1 & fulltime==0 & white==1 & year==1977 & incfarm~=.
replace incfarm_cellmean = 60590 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1978 & incfarm~=.
replace incfarm_cellmean = 63208 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1979 & incfarm~=.
replace incfarm_cellmean = 63208 if incfarm>=50000 & female==0 & fulltime==0 & white==1 & year==1979 & incfarm~=.
replace incfarm_cellmean = 64447 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1980 & incfarm~=.
replace incfarm_cellmean = 64447 if incfarm>=50000 & female==0 & fulltime==0 & white==1 & year==1980 & incfarm~=.
replace incfarm_cellmean = 61356 if incfarm>=50000 & female==0 & fulltime==1 & white==1 & year==1981 & incfarm~=.
replace incfarm_cellmean = 61356 if incfarm>=50000 & female==0 & fulltime==1 & black==1 & year==1981 & incfarm~=.
replace incfarm_cellmean = 61356 if incfarm>=50000 & female==1 & fulltime==0 & white==1 & year==1981 & incfarm~=.
replace incfarm_cellmean = 91015 if incfarm>=75000 & year==1982 & incfarm~=.
replace incfarm_cellmean = 82381 if incfarm>=75000 & year==1983 & incfarm~=.
replace incfarm_cellmean = 83154 if incfarm>=75000 & year==1984 & incfarm~=.
replace incfarm_cellmean = 122398 if incfarm>=99999 & year==1987 & incfarm~=.

*Miscellaneous non-labor income cell means, 1976-1987
gen incss_cellmean = incss
replace incss = 12893 if incss>=9999 & year==1980 & incss~=.
replace incss = 11589 if incss>=9999 & year==1981 & incss~=.
gen incssi_cellmean = incssi
replace incssi = 6250 if incssi>5999 & year==1984 & incssi~=.
gen incwelfr_cellmean = incwelfr
gen incint_cellmean=incint
replace incint_cellmean = 73035 if incint>=50000 & year==1976 & incint~=.
replace incint_cellmean = 71651 if incint>=50000 & year==1977 & incint~=.
replace incint_cellmean = 62534 if incint>=50000 & year==1978 & incint~=.
replace incint_cellmean = 66269 if incint>=50000 & year==1979 & incint~=.
replace incint_cellmean = 71163 if incint>=50000 & year==1980 & incint~=.
replace incint_cellmean = 72861 if incint>=50000 & year==1981 & incint~=.
*replace incint_cellmean = 70242 if incint>=50000 & year==1982 & incint~=.
*Larrimore (2008) reports a cell mean smaller than the censoring point for incint in 1982, so I am leaving the censoring point intact
replace incint_cellmean = 97565 if incint>=75000 & year==1983 & incint~=.
replace incint_cellmean = 94024 if incint>=75000 & year==1984 & incint~=.
gen incdrt_cellmean = incdrt if year<1988
replace incdrt_cellmean = 74448 if incdrt>=50000 & year==1976 & incdrt~=.
replace incdrt_cellmean = 71651 if incdrt>=50000 & year==1977 & incdrt~=.
replace incdrt_cellmean = 74304 if incdrt>=50000 & year==1978 & incdrt~=.
replace incdrt_cellmean = 70785 if incdrt>=50000 & year==1979 & incdrt~=.
replace incdrt_cellmean = 74089 if incdrt>=50000 & year==1980 & incdrt~=.
replace incdrt_cellmean = 71240 if incdrt>=50000 & year==1981 & incdrt~=.
replace incdrt_cellmean = 93788 if incdrt>=75000 & year==1982 & incdrt~=.
replace incdrt_cellmean = 92724 if incdrt>=75000 & year==1983 & incdrt~=.
replace incdrt_cellmean = 87201 if incdrt>=75000 & year==1984 & incdrt~=.
gen incgov_cellmean = incgov if year<1988
replace incgov_cellmean = 61135 if incgov>=29999 & year==1980 & incgov~=.
replace incgov_cellmean = 33808 if incgov>=29999 & year==1981 & incgov~=.
replace incgov_cellmean = 70242 if incgov>=29999 & year==1982 & incgov~=.
replace incgov_cellmean = 42207 if incgov>=29999 & year==1983 & incgov~=.
replace incgov_cellmean = 43336 if incgov>=29999 & year==1985 & incgov~=.
replace incgov_cellmean = 41302 if incgov>=29999 & year==1986 & incgov~=.
replace incgov_cellmean = 48662 if incgov>=29999 & year==1987 & incgov~=.
gen incretir_cellmean = incretir if year<1988
replace incretir_cellmean = 73035 if incretir>=50000 & year==1976 & incretir~=.
replace incretir_cellmean = 71651 if incretir>=50000 & year==1977 & incretir~=.
replace incretir_cellmean = 88167 if incretir>=50000 & year==1979 & incretir~=.
replace incretir_cellmean = 63786 if incretir>=50000 & year==1980 & incretir~=.
replace incretir_cellmean = 70004 if incretir>=50000 & year==1981 & incretir~=.
replace incretir_cellmean = 81636 if incretir>=75000 & year==1982 & incretir~=.
replace incretir_cellmean = 91843 if incretir>=75000 & year==1983 & incretir~=.
replace incretir_cellmean = 92638 if incretir>=75000 & year==1984 & incretir~=.
gen incaloth_cellmean = incaloth if year<1988
replace incaloth_cellmean = 71651 if incaloth>=50000 & year==1977 & incaloth~=.
replace incaloth_cellmean = 62534 if incaloth>=50000 & year==1978 & incaloth~=.
replace incaloth_cellmean = 66269 if incaloth>=50000 & year==1979 & incaloth~=.
replace incaloth_cellmean = 61135 if incaloth>=50000 & year==1980 & incaloth~=.
replace incaloth_cellmean = 70004 if incaloth>=50000 & year==1981 & incaloth~=.
replace incaloth_cellmean = 97565 if incaloth>=50000 & year==1983 & incaloth~=.
replace incaloth_cellmean = 89513 if incaloth>=50000 & year==1984 & incaloth~=.


*****
*1988-1994 
*****

*Primary Earnings, 1988-1995 
gen inclongj_cellmean = inclongj if year>=1988
replace inclongj_cellmean = 148852 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 136582 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 159300 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 151838 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 153098 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 153098 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 124539 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 153098 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 124581 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 143082 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 153098 if inclongj>=99999 & female==1 & fulltime==0 & latino==1 & year==1988 & inclongj~=.
replace inclongj_cellmean = 143204 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 138971 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 154412 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 152647 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 137250 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 137250 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 160834 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 137250 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 125994 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 137250 if inclongj>=99999 & female==1 & fulltime==0 & black==1 & year==1989 & inclongj~=.
replace inclongj_cellmean = 153067 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 159309 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 153072 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 143812 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 124782 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 124782 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 173779 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 124782 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 124782 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 115220 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 153067 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1990 & inclongj~=.
replace inclongj_cellmean = 151763 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 144161 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 135010 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 153090 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 135453 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 132230 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 148513 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 160432 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 132230 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 127641 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1991 & inclongj~=.
replace inclongj_cellmean = 142991 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 133707 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 136560 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 131061 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 121099 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 140743 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 121099 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 128059 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 121099 if inclongj>=99999 & female==1 & fulltime==0 & latino==1 & year==1992 & inclongj~=.
replace inclongj_cellmean = 148241 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 144800 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 143657 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 149557 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 114123 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 114123 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 141543 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 114123 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 139295 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 114123 if inclongj>=99999 & female==1 & fulltime==0 & latino==1 & year==1993 & inclongj~=.
replace inclongj_cellmean = 188027 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 232995 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 205449 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 215571 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 273701 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 159042 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 188154 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 179478 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 179478 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 202593 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 179478 if inclongj>=99999 & female==1 & fulltime==0 & black==1 & year==1994 & inclongj~=.
replace inclongj_cellmean = 187347 if inclongj>=99999 & female==0 & fulltime==1 & white==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 180854 if inclongj>=99999 & female==0 & fulltime==1 & black==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 179894 if inclongj>=99999 & female==0 & fulltime==1 & latino==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 191029 if inclongj>=99999 & female==1 & fulltime==1 & white==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 160143 if inclongj>=99999 & female==1 & fulltime==1 & black==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 212792 if inclongj>=99999 & female==1 & fulltime==1 & latino==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 173157 if inclongj>=99999 & female==0 & fulltime==0 & white==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 458721 if inclongj>=99999 & female==0 & fulltime==0 & black==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 458721 if inclongj>=99999 & female==0 & fulltime==0 & latino==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 154367 if inclongj>=99999 & female==1 & fulltime==0 & white==1 & year==1995 & inclongj~=.
replace inclongj_cellmean = 458721 if inclongj>=99999 & female==1 & fulltime==0 & latino==1 & year==1995 & inclongj~=.

*Secondary Wage Income, 1988-1995
gen oincwage_cellmean = oincwage if year>=1988
replace oincwage_cellmean = 158174 if oincwage>=99999 & female==0 & fulltime==1 & white==1 & year==1994 & oincwage~=.
replace oincwage_cellmean = 125569 if oincwage>=99999 & female==0 & fulltime==1 & black==1 & year==1994 & oincwage~=.
replace oincwage_cellmean = 125569 if oincwage>=99999 & female==1 & fulltime==1 & white==1 & year==1994 & oincwage~=.
replace oincwage_cellmean = 125569 if oincwage>=99999 & female==0 & fulltime==0 & white==1 & year==1994 & oincwage~=.
replace oincwage_cellmean = 207148 if oincwage>=99999 & female==0 & fulltime==1 & white==1 & year==1995 & oincwage~=.
replace oincwage_cellmean = 109775 if oincwage>=99999 & female==0 & fulltime==1 & black==1 & year==1995 & oincwage~=.
replace oincwage_cellmean = 109775 if oincwage>=99999 & female==0 & fulltime==1 & latino==1 & year==1995 & oincwage~=.
replace oincwage_cellmean = 109775 if oincwage>=99999 & female==1 & fulltime==1 & white==1 & year==1995 & oincwage~=.
replace oincwage_cellmean = 109775 if oincwage>=99999 & female==0 & fulltime==0 & white==1 & year==1995 & oincwage~=.
replace oincwage_cellmean = 202541 if oincwage>=99999 & female==1 & fulltime==0 & white==1 & year==1995 & oincwage~=.

*Secondary Self-Employment Income, 1988-1995
gen oincbus_cellmean = oincbus if year>=1988
replace oincbus_cellmean = 157513 if oincbus>=99999 & female==0 & fulltime==1 & white==1 & year==1994 & oincbus~=.
replace oincbus_cellmean = 157513 if oincbus>=99999 & female==1 & fulltime==1 & white==1 & year==1994 & oincbus~=.
replace oincbus_cellmean = 305001 if oincbus>=99999 & female==0 & fulltime==1 & white==1 & year==1995 & oincbus~=.
replace oincbus_cellmean = 357471 if oincbus>=99999 & female==0 & fulltime==1 & latino==1 & year==1995 & oincbus~=.
replace oincbus_cellmean = 357471 if oincbus>=99999 & female==1 & fulltime==1 & white==1 & year==1995 & oincbus~=.
replace oincbus_cellmean = 357471 if oincbus>=99999 & female==0 & fulltime==0 & white==1 & year==1995 & oincbus~=.
replace oincbus_cellmean = 357471 if oincbus>=99999 & female==1 & fulltime==0 & white==1 & year==1995 & oincbus~=.
replace oincbus_cellmean = 357471 if oincbus>=99999 & female==1 & fulltime==0 & latino==1 & year==1995 & oincbus~=.

*Secondary Farm income is either untopcoded or there is no usable information in the internal CPS
*This is also true for the miscellaneous other income sources in the CPS from 1988-1995.

egen post1988_cellmean = rowtotal(inclongj_cellmean oincbus_cellmean oincfarm oincwage_cellmean incss incssi incwelfr incint incdivid incrent incalim incchild incunemp incwkcom incvet increti1 increti2 incsurv1 incsurv2 incdisa1 incdisa2 inceduc incasist incother) if year>=1988 & year<=1995
sort year serial
egen hhincome_post1988cellmean = total(post1988_cellmean), by(year serial)
egen pre1987_cellmean = rowtotal(incwage_cellmean incbus_cellmean incfarm_cellmean incss_cellmean incssi_cellmean incwelfr_cellmean incint_cellmean incdrt_cellmean incidr incretir_cellmean incaloth_cellmean incgov_cellmean)
sort year serial
egen hhincome_cellmean = total(pre1987_cellmean), by(year serial)
replace hhincome_cellmean = hhincome_post1988cellmean if year<=1995 & year>=1988
replace hhincome_cellmean = hhincome if year>1995 | year<1976
replace hhincome_cellmean=0.01 if hhincome_cellmean<=0

save "$MSAINEQ/Data/CPS_raw_microdata.dta", replace 


